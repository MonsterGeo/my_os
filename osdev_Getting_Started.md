
翻译自[osdev/Getting Started]("https://wiki.osdev.org/Getting_Started")

[toc]

文中所有链接是无翻译的原文，以保证信息的准确度

## 你的开始
首先，开发一款操作系统可能是你在计算机上能做到的最具挑战性的事情之一（仅此于在Doom的噩梦级别下击败最终boss）。编写一个操作系统需要大量关于计算机学科中多个复杂领域的知识，包括但不限于了解硬件的工作原理，并且能够读写复杂的汇编语言以及更高级的语言（例如c,c++或pascal）。在此基础上您必须能够围绕抽象理论进行思考，并且能够把握众多思路，现在您是否感到气馁？不必恐惧，因为这些事物同样也是使得操作系统编程充满乐趣和吸引力的因素。


没有任何感觉能比得上在经过数小时的艰苦奋斗后，终于解决问题的那种成就感。一段时间之后，你能够回望过去，看到从零开始创造出的所有事物。你亲手编写的系统能够启动，对硬件执行神奇的操作，并为用户提供用户界面和可供操作的程序。

在创造操作系统的时候，并无需要遵循既定的路线，您可以通过寻找合适的教程来完成这些步骤。一旦您的系统搭建并运行起来，您便可以选择接下来的路径。您的操作系统正是如此-属于你自己的，您拥有至高无上的控制权，一切皆有可能。

## 一个艰难的事实

希望这个事实——操作系统开发是一个复杂且持续不断的过程——不会使您气馁。事实上，操作系统开发确实无与伦比，因为它需要极大的耐心和细致的代码设计，且相较于游戏和基于网络的脚本开发，它能够提供的“即时满足感”非常有限，甚至几乎没有。

现在你已经明白前方工作的艰辛，但若您对此依旧保持兴趣，则请继续前行，进入操作系统程序的领域。请做好面对偶尔发作的疑惑、沮丧、和短暂性发狂。对于我们中的某些人来说，这是暂时的非理性状态。随着时间的推移，并且凭借你足够的拖入，你会发现你自己处在在操作系统有贡献的少数精英之中。如果你在你的学习之路上感到挫败，请以该书重新洗刷自己。希望这能提醒你当初为何踏上这段非理性的旅程。

在这个阶段，阅读[初学者错误](https://wiki.osdev.org/Beginner_Mistakes)页面也将是有益的。

## 责任

人们趋向声称编写低效软件是可以接受的。他们说现在的计算机速度极快，以至于我们察觉不出低效程序的影响。这些声音对于设计操作系统是危险的。这些话语对于当他们编写简单程序的马虎代码时也许是可以的，但当编写一些关键代码时，这些函数可能每秒被调用数千次，因此需要尽可能的去除所有开销。而操作系统应该提供电脑基础资源去运行操作系统，并尽可能减少复杂、抽象和开销。

最后，设计操作系统的人员往往持有一种“无所不包、唯独缺厨房水槽”的心态，他们认为自己应当考虑到一切可能的情况，这虽然是好事，但不应该容忍低质量编写的程序泛滥为代价，当程序出错时、许多操作在底层进行。低质量编写的程序将消耗宝贵的执行时间，并涉及在内存和频率上代价高昂的任务切换。我们鼓励您应当拒绝这些低质量软件编写。

## 必备知识

主要文章：[必备知识](https://wiki.osdev.org/Required_Knowledge)

**注意：如果你觉得你可以跳过这章节，那就跳过吧**

因为这一章需要频繁使用，因此单独开了一个页面

## 制定你的计划

在继续学习之前，思考一下你先从写操作系统这件事情上得到什么。你想从这个项目上得到什么？从事操作系统项目可能有诸多原因，且很多os开发者并不仅仅有一个理由。即使只是说“我只是想”，这也可能足够，尽管您考虑和明确目标与动机的程度越深，您就能越专注你真正想要的东西。

请对自己诚实，不必对自己更宏伟的抱负的项目感到羞耻。尽管他们并不是主要目标，试着对你所有的目标保持支持，不要仅限于你认为的那个主要目的。

请尝试着确定您最感兴趣或认为需要着力研究的操作系统的设计方面。操作系统的开发过程中，尤其是早期阶段，大部分的工作集中在内核设计和开发上，但内核本身也只是大多数操作系统中的一小部分。如果你的主要兴趣在用户体验或网络、或驱动程序，您应该思考是否是你需要是否完全自主编写操作系统，或者你是否会对现有内核上开发这些功能感到同样满足。相当一部分开发操作系统实则是出于对桌面环境设计的真正渴望，因此，自我审视此问题至关重要。

请试着想一下你可能首先想要或同时想要写的任何非操作系统，尤其是那些可能会作为操作系统项目的练习或准备的项目。通常你没有必要现在就开始写操作系统，你提前做的准备越多，情况就会越好。（拖延是另外的一回事）

类似的，若你打算对现有设计进行分支以实现或为了特定目的而修改。请专注这些问题，而非那些一般抽象理论。考虑您需要的现有代码库部分以及你想更改的地方。

请试着明确您项目的一些具体目标，如有必要，请做好规划单独项目的准备。如果你只是简单的打算随意看看会将您引向哪里，也也是可以的。如果是想推翻微软，这同样也可以（尽管不太现实）。一旦明确你想做的事情，你就可以将具体细节分解为特定的目标，并计算实现这些目标所需要的条件。不要试图将过多的相互矛盾的目标纳入一个项目中——如果有不同的尝试需求且目标相互矛盾，应将它们划分为不同的项目。

写一份关于os设计的计划概述也许对你有帮助，其中带有您认为的任何具体要求或细节，这些要求或细节能够阐明您需要帮助的内容，并且如果可能的话，请将其添加到你的仓库中。

最后，回顾项目所需的资源和实践，并决定其可行性。若你知道您只能为该项目投入一定的时间，无论你做什么的，记得考虑这点：请不要过早的立flag，即使你确信自己能够完成目标。操作系统的开发时间需要非常大量的时间，试图在一个学期内完成一个完整的操作系统项目是不切实际的。

## 选择您的开发环境

你需要一个平台来做新系统的开发。遵循通用操作系统的趋势，比较推荐的是GNU/Linux，但很多人还是喜欢用Windows。用GNU/Linux系统的开发者在工具方面上具有轻微的优势，但你可以通过在window上使用Cygwin或者MinGW来解决这点问题。

所需工具：
+ **Binutils**:用于对象文件操作的基本工具
+ **GCC**:GNU编译器合集，GCC包含c,c++,Fortran和Ada等编程语言的编译器。
+ **Make**:自动构建工具，对超过一定量文件的编译十分有效
+ **Grep和Sed**：执行更强大的搜索与替换操作（在数据填充表格时十分有用）
+ **Diffutils**:用于展示两个文件之间的差异
+ **Perl或python**: 你应该安装两种脚本语言其一，有助于操作字符串，这两者提供了数百个模块/包，可以用来做各种事情（Python优先考虑）
+ **汇编**：nams或gas，取决于你的目标cpu
+ **编辑器**:用来写汇编、C或其他语言的程序

您可能不会使用这些工具，但最好备齐以备不时之需，并了解如何使用他们。如果您决定使用其他语言，那么工具的选择取决于你，上述列表的工具对于你来说可能没有任何帮助，下述信息主要对c/c++或汇编语言开发者相关。

## GNU/Linux


我们建议你使用的os开发系统是GNU/Linux。使用该操作系统时，许多GNU开发工具是已近存在的，若没有，你可以使用包管理器（apt,rpm,portage,pacman,apk,etc）去安装你所需的工具。同样，需要制作交叉编译器（cross-compiler），以便您的代码可以允许在不同的平台

常用的编辑器有 Vim emas,kdevelop,komodo编辑等等（笔者喜欢vscode），有人喜欢轻量级编辑器，而不是ide，比如Gedit,Geany和scite。许多人喜欢Midnight Commander。它具有一个文本ui和一个内置编辑器（McEdit），因此十分轻巧，让你快速使用

无需寻找特定发行版本，如果你想知道具体有什么，可以查看Linux发行表，这些系统具有各种特性和形式，只要是相对通用的就可以使用了，如果你不知道什么操作系统对你友好，那么你可以试试Ubuntu、Fedora或Linux Mint.

## Windows
为了获取必要的工具，您应安装Cygwin环境。MinGW或DJGPP是可选的编译工具，但强烈建议使用MSYS2，因为它是最完整且兼容性最高的环境，并且还包含一个包管理器，用于安装库和工具。

微软最近（截至撰写本文时）发布了Windows Subsystem for Linux作为Windows 10的可选功能。它基本上是一个在Windows上运行的真正Ubuntu命令行发行版，无需使用虚拟机。截至撰写本文时，最新的GCC和Binutils（6.1.0和2.27）在此环境中编译和运行正确。使用Bash shell，您可以通过/mnt/<驱动器号>访问您的Windows硬盘。这种解决方案的优势在于，您可以使用所需的任何Windows或Linux工具，而无需确定它们是否在Cygwin中工作。“apt-get”可以安装许多所需工具。

对于上述所有内容，强烈建议构建交叉编译器，这不仅是因为默认编译器针对不同的可执行格式，而且因为通常这是一个好主意。请查阅GCC交叉编译器页面以获取详细信息和建议。

您还需要一个编辑器。使用记事本可以工作，但如果您有一个更完整的编辑器会更容易。例如，Notepad++或Notepad2被许多人使用。如果您熟悉Unix编辑器，可以从Cygwin提供的选项中选择一个（例如，Vim和Emacs，虽然需要一些适应时间，但功能非常强大）。

您还可以使用Visual Studio或免费下载的Visual C++ Express Edition来编写和编译您的操作系统。您将需要一个特殊的配置文件，并且您肯定属于少数，但这确实效果很好。您甚至可以在其上安装Windows SDK，从而实现64位开发。唯一的缺点是不支持内联汇编。

还可以使用Watcom或Borland等工具，但它们各自都有特定的要求，并且在此类工作中并不广泛使用。

另一个考虑因素是，您可能的目标是使您的操作系统成为自托管的，也就是说，您可以使用您的操作系统来编译您的操作系统。如果您的操作系统是用C编写的，那么您的最低要求因此将是C编译器和C库。如果您打算使您的操作系统成为Windows克隆而不是另一个POSIX兼容的操作系统，那么您需要一个执行Windows调用而不是POSIX调用的C库，并且您需要一个仅使用C库而不是执行POSIX调用的C编译器。GCCWIN + PDPCLIB符合这一要求。

## Macos

因为其底层使用的是FreeBSD的用户空间，所以它完全兼容POSIX。所有常用工具都可用（vi、bash、dd、cat、sed、tar、cpio等）。几乎所有教程都可以直接使用。缺失的工具大多与文件系统相关：没有回环设备，没有fdisk，没有mkfs.vfat也没有mtools。但你可以使用diskutil来完成这些任务，或者使用brew或macports来安装这些缺失的工具。

要获取gcc，在旧版本中，你通常需要在第二张安装DVD上有一个mpkg。对于较新的macOS版本（10.13及以上），可以通过在终端中运行“xcode-select --install”来安装命令行XCode（不是IDE，只是工具链）。这将安装gcc、binutils和make。实际上，这个gcc是一个伪装的CLang，但功能足够强大，可以无问题地构建自己的交叉编译器。与从brew或macports安装相比，更推荐使用官方编译器来启动gcc。

## 测试你的操作系统

主要文章：[测试](https://wiki.osdev.org/Testing)

上述文章深入探讨了如何选择测试操作系统的方法以及如何将其与开发过程相结合。文中既讨论了物理测试环境，也涉及了仿真测试环境。

## 保护你的代码

在您构建代码的过程中，您将编写数百甚至数千行代码。您将花费难以计数的时光，深夜熬夜编码，尽管您本应去休息。此时，您最不需要的就是硬盘故障或编写不当的 'rm' 或 'format' 命令将您所有的工作成果毁于一旦。

您需要的是一个版本控制系统。CVS已使用多年，但近年来受到了Subversion、Bazaar、Mercurial和Git等众多竞争者的挑战。如果可能，您应该设置一台远程计算机或服务器作为版本控制服务器，但如果没有这样的机器可用，您也可以在本地开发计算机上托管版本控制系统。只需记得偶尔将代码备份到光盘或FTP。

我们无法强调这一点的重要性：如果您尚未使用源代码控制，您应立即开始这样做。您只需在代码中犯一次严重的错误，就能意识到拥有安全版本化和易于检索的代码的重要性。尽管对于一个小型的私人爱好项目来说，这可能显得有些过度，但一旦养成使用版本控制的习惯，您就会对没有版本控制的情况下是如何做到的表示惊奇

对于Git，您可以在GitHub或Bitbucket上创建您的项目。两者都提供了免费的私有仓库。

在可网络访问的仓库上使用版本控制的一个额外好处是，它使得与其他人协作和寻求帮助变得容易得多。这非常有用，尤其是在论坛上，因为它可以避免不断在消息线程中发布代码更新版本的需求——您只需将对话指向您的仓库，线程中的其他人即可直接访问您的最新更改。如果项目规模扩大，您开始与其他开发者合作（但不要期望这会一夜之间发生），这一点尤为重要。